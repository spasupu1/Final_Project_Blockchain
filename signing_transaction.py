from collections import OrderedDict

import binascii
import os
import Crypto
import Crypto.Random
from Crypto.Hash import SHA
from Crypto.PublicKey import RSA
from Crypto.Signature import PKCS1_v1_5


def upload_data():
	message = []
	all_files = os.listdir("./")
	print (all_files)
	for i in all_files:
		if i[-4:] == ".txt":
			f = open(i, "r")
			contents = f.read()
			message.append(contents)
			print (message)
	return message


def sign_transaction(message, sender_public_address, sender_private_address ):
	private_key = RSA.importKey(binascii.unhexlify(sender_private_address))
	print (private_key)
	signer = PKCS1_v1_5.new(private_key)
	print (signer)
	h = SHA.new(str(message).encode('utf8'))
	print (h)
	print (binascii.hexlify(signer.sign(h)).decode('ascii'))



if __name__ == "__main__":
	sender_public_address = "30819f300d06092a864886f70d010101050003818d0030818902818100d24d3507e87f995dfff4cc16b5a0b2c807e73646e19e248b177054619e5fb2e3733bf26ff22bdcc1f6e5044cbbea929199673bd51c8a32faa846e8e2d7195081e2e03a761f09047114071bd19a0289e4239319e123912f9a70a9a0fa4d5802673a9960d7c40d1acbea6e59fbac0d36c57a5464a57ff1db44764986b6d161c8870203010001"
	sender_private_address = "3082025c02010002818100d24d3507e87f995dfff4cc16b5a0b2c807e73646e19e248b177054619e5fb2e3733bf26ff22bdcc1f6e5044cbbea929199673bd51c8a32faa846e8e2d7195081e2e03a761f09047114071bd19a0289e4239319e123912f9a70a9a0fa4d5802673a9960d7c40d1acbea6e59fbac0d36c57a5464a57ff1db44764986b6d161c88702030100010281804e793eeba7874dac74e15cf2b06db9a8c8c22f4fbdcaec29f6e214aaa49563445a70a923bac3414a239e0bbfb27372a3e01154934e660765df3b2e95cedc045cf617c9b264903fc2a98cfc2d2331b31bbe0c8e903e5229bf5ce09ec142a326406469c1ae84d3844e0306bcf355ba6c5ef280e368d2becbb2bd31214c9b8e6ff1024100e1b1f9fa0025cf27f608b81df3e5f1da107ebbe8decec0040773aadf88488f9db33614616510e6c0e3d1c215d5e4f75277a88f44148a78995f0057157f0004b9024100ee8a1777f0ece5f80c510c9d8e9cbe162f41c0349e77c146a2fed6f124e1cc36212a0eba7e28bbd215f5f092be48220a49adc5635d7178dda4a10506fd94173f0241008882f60858fe85864e3287ead613476df67c317c7107ecec82f55b6d49295a74b0690d7abb7eb594063861848393b264972bc53c109090d173bce8ef7f99ab410240348fd73605af9dc8f7a5d05ad376f467dd07e6fb7143c021f97ea00c48ed3c5b5d19705f65b74213bbe5129ab3351fd3168324f08d4198b9763248f24e64186f0240591f47be50d7b2c2de451d7b255ceedab857999debd701782ca4eb00226a2024dce134978473b6cc51edb8dbdb335917e8d08626b2de3c2a65a7ee050186262c"
	message = "['charan']"
	sign_transaction(message, sender_public_address, sender_private_address)

